--- engineer.py
+++ engineer.py
@@ -95,13 +95,14 @@
         """トレンド系指標の一括作成"""
         feat['ADX_14'] = df.ta.adx(length=14).iloc[:, 0]
         # ルールベースフィルタ用にSMAを作成
-        feat['SMA_5'] = df.ta.sma(length=5)
-        feat['SMA_25'] = df.ta.sma(length=25)
-        feat['SMA_75'] = df.ta.sma(length=75)
-        feat['Dist_SMA5'] = (df['close'] - feat['SMA_5']) / feat['SMA_5']
-        feat['Dist_SMA75'] = (df['close'] - feat['SMA_75']) / feat['SMA_75']
-        feat['Dist_SMA25'] = (df['close'] - feat['SMA_25']) / feat['SMA_25']
-        feat['MA_Diff_5'] = df['close'] / df['close'].rolling(5).mean()
+        sma5 = df.ta.sma(length=5)
+        sma25 = df.ta.sma(length=25)
+        sma75 = df.ta.sma(length=75)
+        feat['Dist_SMA5'] = (df['close'] / sma5) - 1.0
+        feat['Dist_SMA25'] = (df['close'] / sma25) - 1.0
+        feat['Dist_SMA75'] = (df['close'] / sma75) - 1.0
+        feat['Dist_SMA5_25'] = (sma5 / sma25) - 1.0
+        feat['Dist_SMA25_75'] = (sma25 / sma75) - 1.0
         # VWAP関連
         typ_price = (df['high'] + df['low'] + df['close']) / 3
         pv_sum = (typ_price * df['volume']).rolling(5).sum()
@@ -127,9 +128,7 @@
         feat['Dist_Kijun'] = (df['close'] - kijun_sen) / kijun_sen
         past_3d_high = df['high'].shift(1).rolling(3).max()
         feat['New_High_Flag_3'] = (df['close'] > past_3d_high).astype(int)
-        feat['Close_log'] = np.log(df['close'])
-        feat['MA_25_log'] = np.log(df['close'].rolling(25).mean())
-        feat['MA_75_log'] = np.log(df['close'].rolling(75).mean())
+        # Redundant absolute logs removed based on high correlation analysis
         # 長期価格位置 (120日)
         roll_120 = df['close'].rolling(120)
         max_120 = roll_120.max()
@@ -166,18 +165,18 @@
         feat['Log_Return'] = np.log(df['close'] / df['close'].shift(1))
         feat['beta_proxy'] = feat['Log_Return'] - df['Market_Return']
         feat['Downside_Run'] = feat['Log_Return'].clip(upper=0).rolling(5).sum()       
-        feat['Return_Skewness'] = feat['Log_Return'].rolling(20).skew()
+        feat['Return_Skewness_Diff'] = feat['Log_Return'].rolling(20).skew().diff()
         feat['Return_Kurtosis'] = feat['Log_Return'].rolling(20).kurt()
-        feat['Return_1d'] = df['close'].pct_change(1)
+        # Return_1d removed (Redundant with Log_Return)
         feat['Return_3d'] = df['close'].pct_change(3)
         feat['Return_5d'] = df['close'].pct_change(5)
         feat['Return_10d'] = df['close'].pct_change(10)
         feat['Return_20d'] = df['close'].pct_change(20)
-        feat['Return_1d_Lag1'] = feat['Return_1d'].shift(1)
-        feat['Return_1d_Lag2'] = feat['Return_1d'].shift(2)
+        feat['Return_1d_Lag1'] = feat['Log_Return'].shift(1)
+        feat['Return_1d_Lag2'] = feat['Log_Return'].shift(2)
         feat['RSI_9'] = df.ta.rsi(length=9)
+        feat['RSI_9_14_Diff'] = feat['RSI_9'] - df.ta.rsi(length=14)
         feat['RSI_14'] = df.ta.rsi(length=14)
-        feat['RSI_14_norm'] = (df.ta.rsi(length=14) - 50) / 50 # Normalize -1 to 1
         bb = df.ta.bbands(length=20, std=2)
         if bb is not None:
             bb_p_col = [c for c in bb.columns if c.startswith('BBP')][0]
@@ -195,7 +194,7 @@
             feat['Lower_Shadow_Ratio'] = lower_shadow / range_len
             feat['Intraday_Strength'] = (df['close'] - df['open']) / range_len
             feat['Lower_Shadow_MA5'] = feat['Lower_Shadow_Ratio'].rolling(5).mean()
-            feat['Lower_Shadow_Mean'] = ((df[['open', 'close']].min(axis=1) - df['low']) / range_len).rolling(5).mean()
+            # Lower_Shadow_Mean removed (Redundant with Shadow MA5)
         diff = df['close'].diff()
         sign = np.sign(diff).fillna(0)
         is_change = sign != sign.shift(1)
@@ -208,7 +207,7 @@
         prev_close = df['close'].shift(1)
         feat['Gap_Rate'] = (df['open'] / prev_close) - 1.0
         feat['Gap_Abs'] = feat['Gap_Rate'].abs()
-        feat['Gap_Ratio'] = feat['Gap_Rate']
+        # Gap_Ratio removed
         feat['Large_Move_Count'] = (feat['Log_Return'].abs() > 0.03).rolling(20).sum()
         range_len = df['high'] - df['low']
         feat['Range_Ratio_Long'] = range_len.rolling(5).mean() / range_len.rolling(20).mean()
@@ -218,19 +217,14 @@
         feat['RCI_52'] = self._calc_rci(df['close'], 52)
         feat['RCI_9_Diff'] = feat['RCI_9'].diff(1)
         feat['RCI_26_Diff'] = feat['RCI_26'].diff(1)
-        upper, middle, lower = talib.BBANDS(df['close'], timeperiod=25, nbdevup=2.0, nbdevdn=2.0)
-        feat['Upper_Band_2sig'] = np.log(upper)
-        feat['Lower_Band_2sig'] = np.log(lower)
+        upper, middle, lower = talib.BBANDS(df['close'], timeperiod=25, nbdevup=2.0)
+        feat['BB_Bandwidth_25'] = (upper - lower) / middle
+        feat['BB_Upper_Ratio'] = (upper / middle) - 1.0
         feat['momentum_12_1'] = df['close'].shift(20) / df['close'].shift(260) - 1
-        feat['ret_overnight'] = (df['open'] / df['close'].shift(1)) - 1.0
         feat['ret_intraday'] = (df['close'] / df['open']) - 1.0
-        feat['gap_rate'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
-        range_len = (df['high'] - df['low']).replace(0, np.nan)
-        feat['candle_body_ratio'] = abs(df['close'] - df['open']) / range_len
-        feat['up_wick_ratio'] = (df['high'] - df[['open', 'close']].max(axis=1)) / range_len
+        # Redundant gap and wick ratios removed
         feat['win_rate_10d'] = (feat['Log_Return'] > 0).rolling(10).mean()
-        flow = df['overseas_flow_trend']
-        feat['flow_price_interaction'] = flow * feat['Log_Return']
+        # Flow interaction removed due to perfect correlation with Log_Return
         # セクター内相対指標用
         feat['Return_6m'] = df['close'].pct_change(120)
         feat['Return_12m'] = df['close'].pct_change(240)
@@ -251,7 +245,7 @@
         feat['hist_vol_20'] = feat['Log_Return'].rolling(20).std()
         feat['HV_30'] = feat['Log_Return'].rolling(30).std() * np.sqrt(250)
         feat['HV_Slope'] = feat['HV_30'].diff(5)
-        feat['Realized_Skew_20'] = feat['Return_1d'].rolling(20).skew()
+        feat['Realized_Skew_20'] = feat['Log_Return'].rolling(20).skew()
         feat['Ulcer_Index_14'] = df.ta.ui(length=14)
         feat['atr_chg_rate'] = atr.pct_change()
         # セクター内相対指標用 
@@ -274,7 +268,7 @@
         feat['Volume_Change'] = df['volume'].pct_change()
         feat['Volume_Slope_5'] = ta.slope(np.log(df['volume'] + 1), length=5)
         feat['Log_Trading_Cap'] = np.log(df['close'] * df['volume'] + 1)
-        feat['log_vol_change'] = np.log(df['volume'] / df['volume'].shift(1).replace(0, 1))
+        # log_vol_change removed
         feat['MFI_14'] = df.ta.mfi(length=14)
         with np.errstate(divide='ignore', invalid='ignore'):
             hl_log_sq = np.log(df['high'] / df['low']) ** 2
@@ -352,7 +346,7 @@
     def _add_calendar_feature(self, feat, df):
         """時間・カレンダー系指標の一括作成"""
         day_num = df['date'].dt.day
-        feat['Month'] = df['date'].dt.month
+        feat['Month_in_Quarter'] = df['date'].dt.month % 3
         feat['DayOfMonth'] = df['date'].dt.day
         feat['DayOfWeek'] = df['date'].dt.dayofweek